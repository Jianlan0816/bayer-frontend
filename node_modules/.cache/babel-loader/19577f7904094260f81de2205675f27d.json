{"ast":null,"code":"import _slicedToArray from\"/Users/jianlan/Reactide/MyApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/jianlan/Reactide/MyApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";var UserStateContext=/*#__PURE__*/React.createContext();var UserDispatchContext=/*#__PURE__*/React.createContext();function userReducer(state,action){switch(action.type){case\"LOGIN_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{isAuthenticated:true});case\"SIGN_OUT_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{isAuthenticated:false});default:{throw new Error(\"Unhandled action type: \".concat(action.type));}}}function UserProvider(_ref){var children=_ref.children;var _React$useReducer=React.useReducer(userReducer,{isAuthenticated:!!localStorage.getItem(\"id_token\")}),_React$useReducer2=_slicedToArray(_React$useReducer,2),state=_React$useReducer2[0],dispatch=_React$useReducer2[1];return/*#__PURE__*/_jsx(UserStateContext.Provider,{value:state,children:/*#__PURE__*/_jsx(UserDispatchContext.Provider,{value:dispatch,children:children})});}function useUserState(){var context=React.useContext(UserStateContext);if(context===undefined){throw new Error(\"useUserState must be used within a UserProvider\");}return context;}function useUserDispatch(){var context=React.useContext(UserDispatchContext);if(context===undefined){throw new Error(\"useUserDispatch must be used within a UserProvider\");}return context;}export{UserProvider,useUserState,useUserDispatch,loginUser,signOut};// ###########################################################\nfunction loginUser(dispatch,login,password,history,setIsLoading,setError){setError(false);setIsLoading(true);if(!!login&&!!password){setTimeout(function(){localStorage.setItem('id_token',1);setError(null);setIsLoading(false);dispatch({type:'LOGIN_SUCCESS'});history.push('/app/dashboard');},2000);}else{dispatch({type:\"LOGIN_FAILURE\"});setError(true);setIsLoading(false);}}function signOut(dispatch,history){localStorage.removeItem(\"id_token\");dispatch({type:\"SIGN_OUT_SUCCESS\"});history.push(\"/login\");}","map":{"version":3,"sources":["/Users/jianlan/Reactide/MyApp/src/context/UserContext.js"],"names":["React","UserStateContext","createContext","UserDispatchContext","userReducer","state","action","type","isAuthenticated","Error","UserProvider","children","useReducer","localStorage","getItem","dispatch","useUserState","context","useContext","undefined","useUserDispatch","loginUser","signOut","login","password","history","setIsLoading","setError","setTimeout","setItem","push","removeItem"],"mappings":"uSAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,C,2CAEA,GAAIC,CAAAA,gBAAgB,cAAGD,KAAK,CAACE,aAAN,EAAvB,CACA,GAAIC,CAAAA,mBAAmB,cAAGH,KAAK,CAACE,aAAN,EAA1B,CAEA,QAASE,CAAAA,WAAT,CAAqBC,KAArB,CAA4BC,MAA5B,CAAoC,CAClC,OAAQA,MAAM,CAACC,IAAf,EACE,IAAK,eAAL,CACE,sCAAYF,KAAZ,MAAmBG,eAAe,CAAE,IAApC,GACF,IAAK,kBAAL,CACE,sCAAYH,KAAZ,MAAmBG,eAAe,CAAE,KAApC,GACF,QAAS,CACP,KAAM,IAAIC,CAAAA,KAAJ,kCAAoCH,MAAM,CAACC,IAA3C,EAAN,CACD,CAPH,CASD,CAED,QAASG,CAAAA,YAAT,MAAoC,IAAZC,CAAAA,QAAY,MAAZA,QAAY,CAClC,sBAAwBX,KAAK,CAACY,UAAN,CAAiBR,WAAjB,CAA8B,CACpDI,eAAe,CAAE,CAAC,CAACK,YAAY,CAACC,OAAb,CAAqB,UAArB,CADiC,CAA9B,CAAxB,wDAAKT,KAAL,uBAAYU,QAAZ,uBAIA,mBACE,KAAC,gBAAD,CAAkB,QAAlB,EAA2B,KAAK,CAAEV,KAAlC,uBACE,KAAC,mBAAD,CAAqB,QAArB,EAA8B,KAAK,CAAEU,QAArC,UACGJ,QADH,EADF,EADF,CAOD,CAED,QAASK,CAAAA,YAAT,EAAwB,CACtB,GAAIC,CAAAA,OAAO,CAAGjB,KAAK,CAACkB,UAAN,CAAiBjB,gBAAjB,CAAd,CACA,GAAIgB,OAAO,GAAKE,SAAhB,CAA2B,CACzB,KAAM,IAAIV,CAAAA,KAAJ,CAAU,iDAAV,CAAN,CACD,CACD,MAAOQ,CAAAA,OAAP,CACD,CAED,QAASG,CAAAA,eAAT,EAA2B,CACzB,GAAIH,CAAAA,OAAO,CAAGjB,KAAK,CAACkB,UAAN,CAAiBf,mBAAjB,CAAd,CACA,GAAIc,OAAO,GAAKE,SAAhB,CAA2B,CACzB,KAAM,IAAIV,CAAAA,KAAJ,CAAU,oDAAV,CAAN,CACD,CACD,MAAOQ,CAAAA,OAAP,CACD,CAED,OAASP,YAAT,CAAuBM,YAAvB,CAAqCI,eAArC,CAAsDC,SAAtD,CAAiEC,OAAjE,EAEA;AAEA,QAASD,CAAAA,SAAT,CAAmBN,QAAnB,CAA6BQ,KAA7B,CAAoCC,QAApC,CAA8CC,OAA9C,CAAuDC,YAAvD,CAAqEC,QAArE,CAA+E,CAC7EA,QAAQ,CAAC,KAAD,CAAR,CACAD,YAAY,CAAC,IAAD,CAAZ,CAEA,GAAI,CAAC,CAACH,KAAF,EAAW,CAAC,CAACC,QAAjB,CAA2B,CACzBI,UAAU,CAAC,UAAM,CACff,YAAY,CAACgB,OAAb,CAAqB,UAArB,CAAiC,CAAjC,EACAF,QAAQ,CAAC,IAAD,CAAR,CACAD,YAAY,CAAC,KAAD,CAAZ,CACAX,QAAQ,CAAC,CAAER,IAAI,CAAE,eAAR,CAAD,CAAR,CAEAkB,OAAO,CAACK,IAAR,CAAa,gBAAb,EACD,CAPS,CAOP,IAPO,CAAV,CAQD,CATD,IASO,CACLf,QAAQ,CAAC,CAAER,IAAI,CAAE,eAAR,CAAD,CAAR,CACAoB,QAAQ,CAAC,IAAD,CAAR,CACAD,YAAY,CAAC,KAAD,CAAZ,CACD,CACF,CAED,QAASJ,CAAAA,OAAT,CAAiBP,QAAjB,CAA2BU,OAA3B,CAAoC,CAClCZ,YAAY,CAACkB,UAAb,CAAwB,UAAxB,EACAhB,QAAQ,CAAC,CAAER,IAAI,CAAE,kBAAR,CAAD,CAAR,CACAkB,OAAO,CAACK,IAAR,CAAa,QAAb,EACD","sourcesContent":["import React from \"react\";\n\nvar UserStateContext = React.createContext();\nvar UserDispatchContext = React.createContext();\n\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case \"LOGIN_SUCCESS\":\n      return { ...state, isAuthenticated: true };\n    case \"SIGN_OUT_SUCCESS\":\n      return { ...state, isAuthenticated: false };\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\nfunction UserProvider({ children }) {\n  var [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: !!localStorage.getItem(\"id_token\"),\n  });\n\n  return (\n    <UserStateContext.Provider value={state}>\n      <UserDispatchContext.Provider value={dispatch}>\n        {children}\n      </UserDispatchContext.Provider>\n    </UserStateContext.Provider>\n  );\n}\n\nfunction useUserState() {\n  var context = React.useContext(UserStateContext);\n  if (context === undefined) {\n    throw new Error(\"useUserState must be used within a UserProvider\");\n  }\n  return context;\n}\n\nfunction useUserDispatch() {\n  var context = React.useContext(UserDispatchContext);\n  if (context === undefined) {\n    throw new Error(\"useUserDispatch must be used within a UserProvider\");\n  }\n  return context;\n}\n\nexport { UserProvider, useUserState, useUserDispatch, loginUser, signOut };\n\n// ###########################################################\n\nfunction loginUser(dispatch, login, password, history, setIsLoading, setError) {\n  setError(false);\n  setIsLoading(true);\n\n  if (!!login && !!password) {\n    setTimeout(() => {\n      localStorage.setItem('id_token', 1)\n      setError(null)\n      setIsLoading(false)\n      dispatch({ type: 'LOGIN_SUCCESS' })\n\n      history.push('/app/dashboard')\n    }, 2000);\n  } else {\n    dispatch({ type: \"LOGIN_FAILURE\" });\n    setError(true);\n    setIsLoading(false);\n  }\n}\n\nfunction signOut(dispatch, history) {\n  localStorage.removeItem(\"id_token\");\n  dispatch({ type: \"SIGN_OUT_SUCCESS\" });\n  history.push(\"/login\");\n}\n"]},"metadata":{},"sourceType":"module"}